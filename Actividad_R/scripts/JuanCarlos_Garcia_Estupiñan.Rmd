---
title: "Actividad_R"
author: "Juan Carlos García Estupiñán"
date: "2022-11-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Actividad - Programación en R


Esta actividad evaluada consiste en una serie de ejercicios que debe responder dentro de los *chunks* o trozos de código disponibles después de cada pregunta. Recuerda incluir la carga de los paquetes necesarios para la ejecución del código.

## Librerías a usar:

```{r}
library(tidyverse)
```
# Parte 1 (evaluacionR.csv)

## Pregunta 1.

Descargar el archivo evaluacionR.csv e importar dicha información a un dataframe identificado como **df** usando el url que se indica en el trozo de código.

```{r} 

url1="https://www.dropbox.com/s/ms29mvjj0pdq9oz/evaluacionR.csv?dl=1"

# Windows
# download.file(url,"../data_raw/df.csv", method="wininet")
# Linux
download.file(url1,"../data_raw/df.csv", method="wget")

df <- read.csv("../data_raw/df.csv")

```


## Pregunta 2.

¿Cuál es el tipo de cada una de las variables presentes en el dataframe **df**?

```{r}

str(df)
   
```

## Pregunta 3.
 
 ¿Cuántos registros (filas) y variables (columnas) tiene el dataframe **df?**

```{r}
rows <- nrow(df)
cols <- ncol(df)

vector_respuesta <- c(n_row=rows, n_col=cols) 
vector_respuesta
```


## Pregunta 4.
 
Agrupar el dataframe **df** por la variable **Tissue** y agregar columnas con la media de TPM, el valor máximo de TPM y el valor mínimo de TPM para cada tipo de Tissue. Almacenar el resultado en **df1**.

    ```{r}
df1 <- df %>%
      group_by(Tissue) %>%
      summarise(maximo=max(TPM),
                minimo=min(TPM))
df1 %>% head()

    ```


## Pregunta 5.
 
Mostrar mediante un gráfico de puntos la relación entre TPM y nTPM usando el dataframe **df**.

    ```{r}
df %>%
      ggplot(aes(TPM, nTPM)) +
      geom_point(size=1.5) +
      # geom_smooth(method = "lm") +
      labs(
        title = "Actividad 5 Programación R, Máster de Bioinformática VIU",
        subtitle = "Autor: Juan Carlos García Estupiñán",
        x="TPM",
        y="nTPM"
      ) +
      theme_classic() +
      theme(
        plot.title = element_text(face = "bold", size = 14, hjust = .5),
        plot.subtitle = element_text(face = "bold", size = 14, hjust = .5),
        axis.line=element_line(size = 1),
        axis.ticks = element_line(size = 1),
        axis.title = element_text(face = "bold", size = 12),
        axis.text = element_text(face = "bold", size = 11)
      )
    ```


## Pregunta 6.
 
A partir de los datos de **df**, mostrar mediante un gráfico de puntos la relación entre TPM y nTPM para los registros en donde la variable Tissue sea igual a "angular gyrus (white matter)" o igual a "angular gyrus". Colorear de forma distinta dependiendo del tipo de Tissue.

    ```{r warnings=FALSE}
plot_6_y_5 <- df %>% 
      filter(Tissue == "angular gyrus (white matter)" | 
               Tissue == "angular gyrus") %>% 
      ggplot(aes(TPM, nTPM, fill=Tissue)) +
      geom_point(pch=21, color="black", size=1.5) +
      geom_smooth(method = "lm", aes(color=Tissue), 
                  se=FALSE, show.legend = FALSE) +
 labs(
        title = "Actividad 5 Programación R, Máster de Bioinformática VIU",
        subtitle = "Autor: Juan Carlos García Estupiñán",
        x="TPM",
        y="nTPM"
      ) +
  scale_fill_manual(name="Tipo tejido:",
                     values=c("red", "blue")) +
  scale_color_manual(name=NULL,
                     values=c("red", "blue")) +
  theme_classic() +
  theme(
    plot.title = element_text(face = "bold", size = 14, hjust = .5),
    plot.subtitle = element_text(face = "bold", size = 14, hjust = .5),
    axis.line=element_line(size = 1),
    axis.ticks = element_line(size = 1),
    axis.title = element_text(face = "bold", size = 12),
    axis.text = element_text(face = "bold", size = 11),
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 10),
    legend.position = "top",
    legend.background = element_rect(color = "black", size = .75)
    )

plot_6_y_5
```


## Pregunta 7.
 
Mostrar los mismos datos de la pregunta 6 usando facet_grid para separar la información de los dos tejidos en dos gráficos colocados uno al lado del otro.

```{r}

plot_6_y_5 +
  facet_grid(~Tissue) 

```


# Parte 2 (ncrna_NONCODE[v3.0].fasta)

## Pregunta 8.

Descargar el archivo ncrna_NONCODE[v3.0].fasta e importar los datos usando el paquete seqinr visto en las  prácticas de las últimas sesiones. Recuerde que el archivo se encuetra comprimido. Almacenar los datos en el objeto **ncrna**.

```{r warning=FALSE}
url2="http://noncode.org/datadownload/ncrna_NONCODE[v3.0].fasta.tar.gz"

# Windows
# download.file(url,"../data_raw/ncrna.csv", method="wininet")
# Linux
download.file(url2,"../data_raw/ncrna.csv", method="wget")

ncrna <- read.csv("../data_raw/ncrna.csv")

```

## Pregunta 9.

Revisar las funciones disponibles del paquete seqinr. Indicar qué función se puede utilizar para ver el listado y una breve descripción de las funciones incluidas en el paquete.

```{r}



```

## Pregunta 10.

Extraer en un objeto **secuencia** todas las secuencias del objeto **ncrna** usando la función **getSequence** de seqinr. ¿de qué tipo es el objeto **secuencia**? 

```{r}


```

## Pregunta 11.

Extraer  las secuencias que empiezan con "acct". ¿Cuántas secuencias cumplen con la condición?

```{r}



```


## Pregunta 12.

Extraer las secuencias que terminan con "tttttt". ¿Cuántas secuencias cumplen con la condición?

```{r}



```



